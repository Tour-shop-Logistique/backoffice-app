import{c as e,u as s,a as t,d as a,j as l,L as r,e as n,g as i,h as c,i as d}from"./index-BzHVKazg.js";import{r as o}from"./router-BcYogCAZ.js";import{N as x,T as m}from"./notification-Bf4IVRwP.js";import{C as p}from"./circle-plus-PKmViBFI.js";import{T as h}from"./trash-2-c8cfoBNg.js";import{M as u}from"./mail-BRgupu06.js";import{P as g}from"./phone-BFO7Qp3q.js";import{X as b}from"./x-sDzYkWd9.js";import{C as f}from"./chevron-down-Cyk656mU.js";import"./vendor-DOHx2j1n.js";
/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=e("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),N=e("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),v=e("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),w=()=>{const e=s(),{agents:w,isLoading:y,error:k}=t(e=>e.agents),[C,z]=o.useState(!1),[A,S]=o.useState(null),[E,M]=o.useState(null),[q,_]=o.useState(null),[T,D]=o.useState(!1),I=o.useRef(null),[P,L]=o.useState({nom:"",prenoms:"",telephone:"",email:"",password:"",password_confirmation:"",type:"backoffice"}),$=o.useCallback((e,s)=>{I.current&&clearTimeout(I.current),_({type:e,message:s}),I.current=setTimeout(()=>_(null),4e3)},[]);o.useEffect(()=>()=>{I.current&&clearTimeout(I.current)},[]),o.useEffect(()=>{e(a())},[e]);const R=e=>{const{name:s,value:t}=e.target;L(e=>({...e,[s]:t}))},H=e=>{S(e),L({id:e.id,nom:e.nom||"",prenoms:e.prenoms||"",telephone:e.telephone||"",email:e.email||"",type:e.type||"backoffice",password:"",password_confirmation:""}),z(!0)},V=()=>{z(!1),S(null),L({nom:"",prenoms:"",telephone:"",email:"",password:"",password_confirmation:"",type:"backoffice"})},B=async s=>{D(!0);try{const t=s.actif?0:1;await e(n({agentId:s.id,status:t})).unwrap(),$("success","Statut mis à jour pour l'agent."),e(a())}catch(t){$("error","Erreur lors du changement de statut")}finally{D(!1)}},G="w-full border border-slate-200 rounded-lg p-2.5 text-sm font-medium focus:ring-2 focus:ring-slate-900/5 focus:border-slate-900 outline-none transition-all placeholder:text-slate-400 bg-slate-50";return y&&0===w.length?l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[l.jsx(r,{className:"animate-spin text-slate-900",size:40}),l.jsx("p",{className:"text-slate-500 font-medium text-sm tracking-wide uppercase",children:"Chargement des agents..."})]}):l.jsxs("div",{className:"space-y-6 pb-12",children:[l.jsx(x,{notification:q,onClose:()=>_(null)}),l.jsxs("header",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Gestion des Agents"}),l.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"Contrôlez les accès et les permissions des membres de votre équipe."})]}),l.jsxs("button",{onClick:()=>{S(null),V(),z(!0)},className:"inline-flex items-center justify-center px-5 py-2.5 rounded-lg bg-slate-900 text-white text-sm font-bold hover:bg-slate-800 transition-colors shadow-lg shadow-slate-900/10",children:[l.jsx(p,{className:"h-4 w-4 mr-2"}),l.jsx("span",{children:"Nouvel Agent"})]})]}),k&&!y&&l.jsxs("div",{className:"text-red-700 bg-red-50 p-4 rounded-lg border border-red-100 flex items-center gap-2",children:[l.jsx(m,{size:18}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:k})]}),0!==w.length||y?l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsx("div",{className:"hidden md:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[l.jsx("thead",{className:"bg-slate-50",children:l.jsx("tr",{children:["Membre","Contact","Rôle","Statut","Actions"].map(e=>l.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-bold text-slate-400 uppercase tracking-widest "+("Actions"===e?"text-right":""),children:e},e))})}),l.jsx("tbody",{className:"bg-white divide-y divide-slate-50",children:w.map(e=>l.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"w-9 h-9 rounded bg-slate-100 flex items-center justify-center text-slate-500 font-bold border border-slate-200 mr-3 text-xs",children:[e.nom?.[0],e.prenoms?.[0]]}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[e.prenoms," ",e.nom]}),l.jsx("p",{className:"text-[11px] text-slate-400 font-medium",children:e.email})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("p",{className:"text-xs font-semibold text-slate-600 tracking-tight",children:e.telephone})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"inline-flex px-2 py-0.5 rounded text-[9px] font-bold uppercase tracking-wider border "+("backoffice"===e.type?"bg-slate-50 text-slate-600 border-slate-200":"bg-amber-50 text-amber-600 border-amber-200"),children:e.type})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("button",{onClick:()=>B(e),disabled:T,className:"group flex items-center gap-2 py-1 px-3 rounded-full border transition-all "+(e.actif?"bg-green-50 border-green-100 text-green-600":"bg-slate-50 border-slate-200 text-slate-400"),children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full "+(e.actif?"bg-green-500 shadow-[0_0_5px_rgba(34,197,94,0.4)]":"bg-slate-300")}),l.jsx("span",{className:"text-[10px] font-bold uppercase tracking-tight",children:e.actif?"Actif":"Inactif"})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:l.jsxs("div",{className:"flex justify-end gap-1",children:[l.jsx("button",{onClick:()=>H(e),disabled:T,className:"p-1.5 text-slate-400 hover:text-slate-900 hover:bg-slate-100 rounded transition-colors",children:l.jsx(N,{size:16})}),l.jsx("button",{onClick:()=>M(e),disabled:T,className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:l.jsx(h,{size:16})})]})})]},e.id))})]})}),l.jsx("div",{className:"md:hidden divide-y divide-slate-100",children:w.map(e=>l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"w-10 h-10 rounded bg-slate-100 flex items-center justify-center text-slate-500 font-bold border border-slate-200 text-xs",children:[e.nom?.[0],e.prenoms?.[0]]}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-sm font-bold text-slate-900",children:[e.prenoms," ",e.nom]}),l.jsx("span",{className:"inline-flex px-1.5 py-0.5 rounded text-[8px] font-bold uppercase tracking-wider border mt-1 "+("backoffice"===e.type?"bg-slate-50 text-slate-600 border-slate-200":"bg-amber-50 text-amber-600 border-amber-200"),children:e.type})]})]}),l.jsxs("div",{className:"flex gap-1.5",children:[l.jsx("button",{onClick:()=>H(e),className:"p-2 text-slate-500 hover:text-slate-900 bg-slate-50 rounded-lg border border-slate-100",children:l.jsx(N,{size:16})}),l.jsx("button",{onClick:()=>M(e),className:"p-2 text-red-500 bg-red-50 rounded-lg border border-red-100",children:l.jsx(h,{size:16})})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] font-medium text-slate-500",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(u,{size:12,className:"text-slate-300"}),l.jsx("span",{className:"truncate",children:e.email})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(g,{size:12,className:"text-slate-300"}),l.jsx("span",{children:e.telephone})]})]}),l.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-50",children:[l.jsxs("button",{onClick:()=>B(e),disabled:T,className:"flex items-center gap-2 py-1 px-3 rounded-full border transition-all "+(e.actif?"bg-green-50 border-green-100 text-green-600":"bg-slate-50 border-slate-200 text-slate-400"),children:[l.jsx("div",{className:"w-1 h-1 rounded-full "+(e.actif?"bg-green-500":"bg-slate-300")}),l.jsx("span",{className:"text-[9px] font-bold tracking-tight uppercase",children:e.actif?"Actif":"Inactif"})]}),l.jsxs("span",{className:"text-[8px] text-slate-300 font-bold uppercase tracking-widest",children:["ID: ",e.id.substring(0,6)]})]})]},e.id))})]}):l.jsxs("div",{className:"text-center py-20 bg-white rounded-lg border border-slate-200",children:[l.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 border border-slate-100",children:l.jsx(v,{size:32,className:"text-slate-300"})}),l.jsx("p",{className:"text-lg font-bold text-slate-800 tracking-tight",children:"Aucun agent enregistré"}),l.jsx("p",{className:"text-slate-500 mt-2 text-sm max-w-xs mx-auto",children:"Vous n'avez pas encore d'agents configurés pour cette agence."}),l.jsx("button",{onClick:()=>{S(null),V(),z(!0)},className:"mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-900 text-sm font-bold rounded-lg transition-colors",children:"Créer le premier agent"})]}),E&&l.jsx("div",{className:"fixed inset-0 bg-slate-950/60 flex justify-center items-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 border border-slate-100 overflow-hidden",children:[l.jsxs("div",{className:"flex flex-col items-center text-center",children:[l.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-full flex items-center justify-center mb-4",children:l.jsx(m,{className:"text-red-500",size:24})}),l.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Supprimer l'accès ?"}),l.jsxs("p",{className:"mt-2 text-sm text-slate-500",children:["Êtes-vous sûr de vouloir retirer ",l.jsxs("span",{className:"font-bold text-slate-900",children:[E.prenoms," ",E.nom]})," de votre équipe ? Cette action est immédiate."]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-8",children:[l.jsx("button",{onClick:()=>M(null),disabled:T,className:"px-4 py-2 rounded-lg border border-slate-200 text-slate-600 text-xs font-bold hover:bg-slate-50 transition-colors uppercase tracking-widest",children:"Annuler"}),l.jsxs("button",{onClick:async()=>{if(E){D(!0);try{(await e(i(E.id)).unwrap()).success?($("success",`L'agent ${E.nom} a été supprimé.`),e(a()),M(null)):$("error","Erreur lors de la suppression")}catch(s){$("error",s.message||"Erreur lors de la suppression")}finally{D(!1)}}},disabled:T,className:"px-4 py-2 bg-red-600 text-white text-xs font-bold rounded-lg hover:bg-red-700 transition-colors uppercase tracking-widest flex items-center justify-center gap-2 shadow-lg shadow-red-600/10",children:[T?l.jsx(r,{className:"animate-spin",size:14}):l.jsx(h,{size:14}),"Supprimer"]})]})]})}),C&&l.jsx("div",{className:"fixed inset-0 bg-slate-950/60 flex justify-center items-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden border border-slate-200 flex flex-col max-h-[90vh]",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-white",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-bold text-slate-900 tracking-tight",children:A?"Édition de l'Agent":"Nouveau Compte Agent"}),l.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Remplissez les informations de connexion de l'agent."})]}),l.jsx("button",{onClick:V,className:"p-1.5 rounded-lg text-slate-400 hover:text-slate-900 hover:bg-slate-50 transition-colors",children:l.jsx(b,{size:20})})]}),l.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),!T){D(!0);try{if(A){const{id:s,...t}=P;t.password||(delete t.password,delete t.password_confirmation);(await e(c({agentId:s,agentData:t})).unwrap()).success?($("success","Agent modifié avec succès."),e(a()),V()):$("error","Erreur lors de la modification")}else{(await e(d(P)).unwrap()).success?($("success","Agent créé avec succès."),e(a()),V()):$("error","Erreur lors de l'ajout")}}catch(t){$("error",t.message||"Erreur lors de la soumission.")}finally{D(!1)}}},className:"flex-1 flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-8 space-y-6 overflow-y-auto custom-scrollbar",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:["Prénoms ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"prenoms",value:P.prenoms||"",onChange:R,placeholder:"Ex: Jean",className:G,required:!0})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:["Nom ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"nom",value:P.nom||"",onChange:R,placeholder:"Ex: Dupont",className:G,required:!0})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:["Mobile Pro ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(g,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),l.jsx("input",{type:"text",name:"telephone",value:P.telephone||"",onChange:R,placeholder:"+225 ...",className:`${G} pl-10`,required:!0})]})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:["Type de Profil ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{name:"type",value:P.type||"backoffice",onChange:R,className:`${G} appearance-none cursor-pointer`,children:[l.jsx("option",{value:"backoffice",children:"Accès Backoffice"}),l.jsx("option",{value:"agence",children:"Accès Agence"})]}),l.jsx(f,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",size:14})]})]})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:["Email ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),l.jsx("input",{type:"email",name:"email",value:P.email||"",onChange:R,placeholder:"agent@tousshop.com",className:`${G} pl-10`,required:!0})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:[A?"Changer MDP":"Mot de passe"," ",!A&&l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"password",name:"password",value:P.password||"",onChange:R,placeholder:"••••••••",className:G,required:!A})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest ml-1",children:"Confirmation"}),l.jsx("input",{type:"password",name:"password_confirmation",value:P.password_confirmation||"",onChange:R,placeholder:"••••••••",className:G,required:!A})]})]}),A&&l.jsxs("div",{className:"p-3 bg-slate-50 border border-slate-100 rounded-lg flex gap-3 text-slate-500 text-[10px] font-medium leading-relaxed italic uppercase tracking-wider",children:[l.jsx(j,{size:14,className:"shrink-0 text-slate-400"}),l.jsx("p",{children:'Laissez les champs "Mot de passe" vides pour conserver l\'actuel.'})]})]}),l.jsxs("div",{className:"p-6 bg-slate-50 border-t border-slate-100 flex items-center justify-between shrink-0",children:[l.jsx("button",{type:"button",onClick:V,className:"text-xs font-bold text-slate-400 hover:text-slate-600 uppercase tracking-widest transition-colors",children:"Annuler"}),l.jsx("button",{type:"submit",disabled:T,className:"px-6 py-2.5 rounded-lg bg-slate-900 text-white text-xs font-bold uppercase tracking-widest shadow-lg shadow-slate-900/10 hover:bg-slate-800 transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:T?l.jsx(r,{className:"animate-spin h-4 w-4"}):A?"Sauvegarder":"Créer l'agent"})]})]})]})})]})};export{w as default};
